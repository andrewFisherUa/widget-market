!function e(t,n,o){function r(s,c){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!c&&a)return a(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var h=n[s]={exports:{}};t[s][0].call(h.exports,function(e){var n=t[s][1][e];return r(n||e)},h,h.exports,e,t,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(e,t,n){"use strict";var o={ajax:function(e,t){var n=e,o=(t=t||{}).errorFn||function(){},r=t.successFn||function(){},i=t.type||"GET",s=t.data||{},c=JSON.stringify(s);if(i=i.toUpperCase(),window.XMLHttpRequest)a=new XMLHttpRequest;else var a=new ActiveXObject("Microsoft.XMLHTTP");if("GET"==i){c=null,n.indexOf("?")<0&&(n+="?1=1");for(var h in s)s.hasOwnProperty(h)&&(n+="&"+h+"="+s[h])}a.open(i,n,!0),a.onreadystatechange=function(){4==a.readyState?200==a.status?r({response:a.responseText}):o({status:a.status}):o({status:a.readyState})},a.onreadystatechange=function(){4==a.readyState&&(console.log([17,a.status]),200==a.status?r(a.responseText):o({status:a.status}))};try{a.withCredentials=t.withCredentials||!1,a.send(c)}catch(e){}}};t.exports=o},{}],2:[function(e,t,n){"use strict";function o(e){this.parent=e,this.li=null,this.ul=null,this.name=null,this.checkbox=null,this.id=null,this.checkedTops={},this.onclickFn=function(e){},this.oncheckFn=function(e){}}o.prototype.clearBranch=function(e){for(;e.firstChild;){var t=e.firstChild.querySelector("ul");t&&this.clearBranch(t),e.removeChild(e.firstChild)}e.parentNode.removeChild(e)},o.prototype.checkResult=function(e,t){for(var n=e&&e.firstChild;n;n=n.nextSibling)if(1===n.nodeType&&"li"===n.nodeName.toLowerCase())if(n.firstChild.querySelector("input").checked)t[n.dataset.id]=n.firstChild.lastChild.innerHTML;else{var o=n.querySelector("ul");o&&this.checkResult(o,t)}},o.prototype.setInputByChildren=function(){this.parent?this.parent.setInputByChildren():(this.checkedTops={},this.checkResult(this.ul,this.checkedTops),this.afterChecked.call(this))},o.prototype.checkInput=function(e){return!(!this.checkbox||!this.checkbox.checked)},o.prototype.getContailer=function(e){this.ul=e,this.li&&this.li.appendChild(e)},o.prototype.show=function(e,t){this.parent,e.appendChild(this.createTopNode(t))},o.prototype.createTopNode=function(e){var t=this;this.name=e.name,this.id=e.id,this.li=document.createElement("LI"),this.li.dataset.id=e.id;var n=document.createElement("DIV");this.checkbox=document.createElement("input"),this.checkbox.type="checkbox",e.hasOwnProperty("ch2")&&e.ch2&&(this.checkbox.checked=!0),this.checkbox.onclick=function(){var e=this.checked;t.oncheckFn(),this.checked=e,t.ul,t.parent&&t.parent.setInputByChildren()};var o=document.createElement("span");o.className="pushopen";var r=document.createElement("span");return e.hasOwnProperty("found")&&e.found&&(r.style.color="#0000FF"),r.innerHTML=this.name,e.childrenCount?(o.innerHTML="+",o.style.cursor="pointer",o.onclick=function(){t.onclickFn.call(t)},r.onclick=function(){t.onclickFn.call(t)}):o.innerHTML=" ",this.li.appendChild(n),n.appendChild(o),n.appendChild(this.checkbox),n.appendChild(r),this.li},t.exports=o},{}],3:[function(e,t,n){"use strict";function o(e){this.rootId=90401,this.rootName="Категории",this.body=e,this.rootNode=new r(null),this.rootNode.afterChecked=function(){console.log([111,"настаивай как хочешь"])};var t=document.createElement("UL");this.body.appendChild(t);var n={name:this.rootName,id:this.rootId};this.rootNode.show(t,n)}var r=e("./mysinglenode"),i=e("./httpclient");o.prototype.setFunctionCh2=function(e){this.rootNode.afterChecked=e},o.prototype.openInd=function(e){if(e.psg.length){var t="https://widget2.market-place.su/admin/categories/0/open?data="+encodeURIComponent(JSON.stringify(e)),n=this,o=this.rootNode;i.ajax(t,{errorFn:function(e){console.log([1,"error",e])},successFn:function(e){try{var t=JSON.parse(e);console.log([558,"tree conf --",t]),t.hasOwnProperty(n.rootId)&&(n.openTree(t,{parent:o}),o.setInputByChildren())}catch(e){console.log("битая конфигурация",e)}},withCredentials:!0})}},o.prototype.openSearch=function(e){if(e.name){e.psg=[];var t;for(t in this.rootNode.checkedTops)e.psg.push(t);var n="https://widget2.market-place.su/admin/categories/0/research?data="+encodeURIComponent(JSON.stringify(e)),o=this,r=this.rootNode;i.ajax(n,{errorFn:function(e){console.log([1,"error",e])},successFn:function(e){try{var t=JSON.parse(e);console.log([558,"tree conf --",t]),t.hasOwnProperty(o.rootId)&&(o.rootNode.clearBranch(o.rootNode.ul),o.openTree(t,{parent:r}))}catch(e){console.log("битая конфигурация",e)}},withCredentials:!0})}},o.prototype.openStart=function(e){var t="https://widget2.market-place.su/admin/categories";(e=e||{}).hasOwnProperty("id")&&(t+="/"+e.id);n=this.rootNode;if(e.hasOwnProperty("parent"))var n=e.parent;var o=this;i.ajax(t,{errorFn:function(e){console.log([1,"error",e])},successFn:function(e){try{var t=JSON.parse(e);o.openBranch(t.data,{parent:n})}catch(e){console.log("битая конфигурация",e)}},withCredentials:!0})},o.prototype.openTree=function(e,t){var n=this;if(e.hasOwnProperty([t.parent.id])){var o=document.createElement("UL");t.parent.getContailer(o);var i;for(i in e[t.parent.id]){var s=new r(t.parent);s.onclickFn=function(e){var t=this.li.querySelector("span.pushopen");if(this.ul)""==this.li.className?(this.li.className="cl",t.innerHTML="+"):(this.li.className="",t.innerHTML="-");else{t.innerHTML="-";var o={id:this.id,parent:this};n.openStart(o)}},s.oncheckFn=function(e){for(var t=n.rootNode.ul.querySelectorAll("input[type='checkbox']"),o=0,r=t.length;o<r;o++)t[o].checked=!1},s.show(o,e[t.parent.id][i]),n.openTree(e,{parent:s})}}},o.prototype.openBranch=function(e,t){var n=this;e=e||[{name:"лист 1",id:1},{name:"лист 2",id:2},{name:"лист 3",id:3},{name:"лист 4",id:4},{name:"лист 5",id:5}];var o=document.createElement("UL");t.parent.getContailer(o);for(var i=0,s=e.length;i<s;i++){var c=new r(t.parent);c.onclickFn=function(e){var t=this.li.querySelector("span.pushopen");if(this.ul)""==this.li.className?(this.li.className="cl",t.innerHTML="+"):(this.li.className="",t.innerHTML="-");else{t.innerHTML="-";var o={id:this.id,parent:this};n.openStart(o)}},c.oncheckFn=function(e){for(var t=n.rootNode.ul.querySelectorAll("input[type='checkbox']"),o=0,r=t.length;o<r;o++)t[o].checked=!1},c.show(o,e[i])}},t.exports=o},{"./httpclient":1,"./mysinglenode":2}],4:[function(e,t,n){"use strict";function o(e,t,n,o,i,s,c,a){this.src_id=e.dataset.id,this.searchInput=n.querySelector("input.microsearch_input"),this.searchInput.value="",this.searchButton=n.querySelector("button.microsearch_button"),this.TreeBody=n.querySelector("#teletree"),this.TreeBody.innerHTML="",this.mytree=new r(this.TreeBody);h=this;this.selfCloseNode=function(e){e.parentNode.removeChild(e),"function"==typeof c&&c()},this.mytree.setFunctionCh2(function(){"function"==typeof s&&s(this.checkedTops)}),this.rootId=90401;var h=this;if(this.searchButton.onclick=function(){var e={name:h.searchInput.value};h.mytree.openSearch(e)},this.searchInput.onkeyup=function(e){if(13==(e=e||window.event).keyCode){var t={name:h.searchInput.value};return h.mytree.openSearch(t),!1}},i.length){l={psg:i};this.mytree.openInd(l)}else{var l={id:[this.rootId]};this.mytree.openStart(l)}}var r=e("./../models/mysingletree");t.exports=o,window.ContextCategory=o},{"./../models/mysingletree":3}]},{},[4]);